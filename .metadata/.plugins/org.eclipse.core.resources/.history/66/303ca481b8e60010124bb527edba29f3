package com.ripplesystem.foobar;

import javax.jdo.PersistenceManager;

import com.google.inject.Scopes;
import com.google.inject.servlet.ServletModule;
import com.ripplesystem.foobar.impl.GaeInteropUserService;
import com.ripplesystem.foobar.impl.StdoutLogger;
import com.ripplesystem.foobar.service.FoobarDataService;
import com.ripplesystem.foobar.service.FoobarService;
import com.ripplesystem.foobar.servlet.GetTokenForDeviceServlet;
import com.ripplesystem.foobar.servlet.TestServlet;
import com.ripplesystem.gae.PMF;

public class FoobarServletModule extends ServletModule
{
	@Override
	protected void configureServlets()
	{
		// Configure interface to concrete class mapping
		bind(ILogger.class).to(StdoutLogger.class);
		bind(IUserService.class).to(GaeInteropUserService.class);
		bind(PersistenceManager.class).toInstance(PMF.get().getPersistenceManager());
		bind(FoobarDataService.class).in(Scopes.SINGLETON);
		bind(FoobarService.class).in(Scopes.SINGLETON);
				
		// Configure url-to-servlet mapping 
		serve("/Test").with(TestServlet.class);
		serve("/foobar/GetTokenForDevice").with(GetTokenForDeviceServlet.class);
	}
}
